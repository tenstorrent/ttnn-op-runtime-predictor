# SPDX-FileCopyrightText: (c) 2025 Tenstorrent Inc.

# SPDX-License-Identifier: Apache-2.0

import argparse
from create_dataset_eltwise_unary import create_dataset_eltwise_unary
from create_dataset_concatenate_heads import create_dataset_concatenate_heads
from create_dataset_create_qkv_heads import create_dataset_create_qkv_heads

#Global dictionary of op_name : op_category. Add here as needed.
OP_CATEGORIES = {
    "exp": "eltwise_unary",
    "concatenate_heads": "concatenate_heads",
    "create_qkv_heads": "create_qkv_heads",
}

def main(op_name, op_category, sweep_vectors, sweep_results):
    if op_category is None:
        if op_name not in OP_CATEGORIES:
            raise ValueError(f"Op '{op_name}' has no op category.")
        op_category = OP_CATEGORIES[op_name]
    
    #Add op categories here as needed
    if op_category == "eltwise_unary":
        create_dataset_eltwise_unary(op_name, sweep_vectors, sweep_results)
    elif op_category == "concatenate_heads":
        create_dataset_concatenate_heads(op_name, sweep_vectors, sweep_results)
    elif op_category == "create_qkv_heads":
        create_dataset_create_qkv_heads(op_name, sweep_vectors, sweep_results)
    else:
        raise ValueError(f"Unsupported op category: {op_category}")
        

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Create dataset for an op using sweep framework output .json files.")
    parser.add_argument(
        "--op_name", required=True, help="Specify op name."
    )
    parser.add_argument(
        "--op_category", required=False, help="Specify op category."
    )
    parser.add_argument(
        "--sweep_vectors", required=True, help="Specify sweep vector .json file generated by sweeps_parameter_generator.py."
    )
    parser.add_argument(
        "--sweep_results", required=True, help="Specify results of sweep .json file generated by sweeps_runner.py."
    )
    args = parser.parse_args()
    main(args.op_name, args.op_category, args.sweep_vectors, args.sweep_results)
